(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{2056:(e,t,s)=>{"use strict";s.d(t,{Et:()=>a,J9:()=>n,ND:()=>l,yv:()=>i});let r={COMMUTE_RECORDS:"go-home-commute-records",MOOD_DATA:"go-home-mood-data"};function i(){let e=function(){try{let e=localStorage.getItem(r.COMMUTE_RECORDS);return e?JSON.parse(e):[]}catch(e){return[]}}(),t=new Date().toDateString();return e.filter(e=>new Date(e.timestamp).toDateString()===t)}function a(){let e=function(){try{let e=localStorage.getItem(r.MOOD_DATA);return e?JSON.parse(e):[]}catch(e){return[]}}(),t=new Date().toDateString();return e.filter(e=>new Date(e.timestamp).toDateString()===t)}function l(){return localStorage.getItem("go-home-uuid")}function n(e){localStorage.setItem("go-home-uuid",e)}},5010:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});var r=s(5155),i=s(7410);function a(e){let{mood:t}=e;return(0,r.jsx)("div",{className:"bg-github-card rounded-lg p-4 border border-transparent hover:border-github-muted transition-colors",children:(0,r.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,r.jsxs)("div",{className:"flex items-center mr-2",children:[(0,r.jsx)("img",{src:(0,i.T)(t.nickname,"pixel-art"),alt:"아바타",className:"w-8 h-8 rounded-full border border-github-border bg-white"}),(0,r.jsx)("span",{className:"text-2xl ml-1",children:t.emoji})]}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsx)("div",{className:"text-github-text font-medium truncate",children:t.nickname}),(0,r.jsx)("div",{className:"text-github-muted text-sm flex-shrink-0",children:new Date(t.timestamp).toLocaleTimeString("ko-KR",{hour:"2-digit",minute:"2-digit"})})]}),(0,r.jsx)("div",{className:"text-github-text text-sm leading-relaxed",children:t.message})]})]})})}},7300:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>F});var r=s(5155),i=s(2115);function a(e){let{type:t,onClick:s,disabled:a=!1,isLoading:l=!1,hasRecorded:n=!1,recordTime:o}=e,[d,c]=(0,i.useState)(!1),m=async()=>{if(!a&&!l){c(!0);try{await s()}finally{c(!1)}}};return(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("button",{onClick:m,disabled:a||l||n,className:"\n          w-full py-2 px-3 rounded-md border border-github-borderLight bg-github-btnBg text-github-btnText text-xs font-semibold shadow-sm transition-all duration-150\n          ".concat(n?"bg-github-muted text-github-text cursor-not-allowed":"출근"===t?"bg-github-green hover:bg-github-green-hover text-white":"bg-orange-600 hover:bg-orange-700 text-white","\n          ").concat(d?"scale-95":"","\n          ").concat(a||l||n?"opacity-60 cursor-not-allowed":"hover:bg-github-btnHover hover:border-github-border","\n        "),children:[l&&(0,r.jsx)("div",{className:"inline-block animate-spin rounded-full h-4 w-4 border-b-2 border-github-btnText mr-2"}),l?"처리 중...":n?"".concat(t," 완료"):t]}),n&&o&&(0,r.jsx)("div",{className:"text-center",children:(0,r.jsxs)("div",{className:"text-github-muted text-xs mt-1",children:[t," 시간: ",o]})})]})}let l=[{emoji:"\uD83D\uDE0A",label:"행복"},{emoji:"\uD83D\uDE03",label:"신남"},{emoji:"\uD83D\uDE0C",label:"평온"},{emoji:"\uD83D\uDE34",label:"졸림"},{emoji:"\uD83D\uDE24",label:"열심"},{emoji:"\uD83D\uDE05",label:"힘듦"},{emoji:"\uD83D\uDE14",label:"우울"},{emoji:"\uD83D\uDE21",label:"화남"}];function n(e){let{onSubmit:t,isLoading:s=!1,disabled:a=!1}=e,[n,o]=(0,i.useState)(""),[d,c]=(0,i.useState)("");return(0,r.jsxs)("div",{className:"bg-github-card rounded-md p-4",children:[(0,r.jsx)("h3",{className:"text-github-text font-medium mb-3 text-sm",children:"오늘 기분은 어떠세요?"}),(0,r.jsxs)("form",{onSubmit:e=>{e.preventDefault(),n&&d.trim()&&!s&&!a&&(t(n,d.trim()),c(""))},className:"space-y-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-github-muted text-xs mb-1",children:"기분 선택"}),(0,r.jsx)("div",{className:"flex justify-center",children:(0,r.jsx)("div",{className:"grid grid-cols-4 gap-1",children:l.map(e=>(0,r.jsx)("button",{type:"button",onClick:()=>o(e.emoji),disabled:a,className:"\n                    p-1 rounded-md text-base transition-all duration-200\n                    ".concat(n===e.emoji?"bg-github-green text-white":"bg-github-bg border border-thin border-github-borderLight text-github-text hover:border-github-muted","\n                    ").concat(a?"opacity-50 cursor-not-allowed":"hover:scale-105","\n                  "),title:e.label,children:e.emoji},e.emoji))})})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{htmlFor:"message",className:"block text-github-muted text-xs mb-1 flex items-center justify-between",children:[(0,r.jsx)("span",{children:"한 줄 메시지"}),(0,r.jsxs)("span",{className:"text-github-muted text-xs ml-2",children:[d.length,"/100"]})]}),(0,r.jsx)("textarea",{id:"message",value:d,onChange:e=>c(e.target.value),disabled:a||s,placeholder:"오늘 기분을 한 줄로 표현해보세요...",className:"w-full px-2 py-1 bg-github-bg border border-github-borderLight rounded-md text-github-text placeholder-github-muted text-xs focus:outline-none focus:ring-2 focus:ring-github-green focus:border-github-green transition-all duration-150 resize-none",rows:2,maxLength:100})]}),(0,r.jsx)("button",{type:"submit",disabled:!n||!d.trim()||s||a,className:"\n            w-full py-2 px-3 rounded-md border border-github-borderLight bg-github-btnBg text-github-btnText text-xs font-semibold shadow-sm transition-all duration-150\n            ".concat(n&&d.trim()&&!s&&!a?"hover:bg-github-btnHover hover:border-github-border":"opacity-60 cursor-not-allowed","\n          "),children:s?(0,r.jsxs)("div",{className:"flex items-center justify-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"공유 중..."]}):"기분 공유하기"})]})]})}var o=s(4065),d=s(2502);function c(e){let{commutes:t,moods:s,myUuid:a}=e,[l,n]=(0,i.useState)({totalUsers:0,earlyBird:"아직 없음",nightOwl:"아직 없음",moodDistribution:[],commuteTimesGo:[],commuteTimesLeave:[],myGoRank:null,myLeaveRank:null,goTotal:0,leaveTotal:0});return(0,i.useEffect)(()=>{let e=new Date,r=new Date(e.getFullYear(),e.getMonth(),e.getDate()).getTime(),i=r+864e5,l=t.filter(e=>e.timestamp>=r&&e.timestamp<i),o=s.filter(e=>e.timestamp>=r&&e.timestamp<i),d=l.filter(e=>"출근"===e.type).sort((e,t)=>e.timestamp-t.timestamp),c=l.filter(e=>"퇴근"===e.type).sort((e,t)=>e.timestamp-t.timestamp),m=d.findIndex(e=>e.uuid===a),h=c.findIndex(e=>e.uuid===a),u=new Set([...o.map(e=>e.nickname),...l.map(e=>e.nickname)]).size,x=d[0],b=c[c.length-1],g={};o.forEach(e=>{g[e.emoji]=(g[e.emoji]||0)+1});let f=Object.entries(g).map(e=>{let[t,s]=e;return{emoji:t,count:s}}).sort((e,t)=>t.count-e.count).slice(0,5),p={};d.forEach(e=>{let t=new Date(e.timestamp).getHours();p[t]=(p[t]||0)+1});let j=Object.entries(p).map(e=>{let[t,s]=e;return{hour:parseInt(t),count:s}}).sort((e,t)=>e.hour-t.hour),v={};c.forEach(e=>{let t=new Date(e.timestamp).getHours();v[t]=(v[t]||0)+1});let N=Object.entries(v).map(e=>{let[t,s]=e;return{hour:parseInt(t),count:s}}).sort((e,t)=>e.hour-t.hour);n({totalUsers:u,earlyBird:(null==x?void 0:x.nickname)||"아직 없음",nightOwl:(null==b?void 0:b.nickname)||"아직 없음",moodDistribution:f,commuteTimesGo:j,commuteTimesLeave:N,myGoRank:m>=0?m+1:null,myLeaveRank:h>=0?h+1:null,goTotal:d.length,leaveTotal:c.length})},[t,s,a]),(0,r.jsxs)("div",{className:"bg-github-card rounded-md shadow-sm p-4",children:[(0,r.jsx)("h2",{className:"text-github-text font-semibold mb-4 text-sm",children:"\uD83D\uDCCA 오늘의 통계"}),(l.myGoRank||l.myLeaveRank)&&(0,r.jsxs)("div",{className:"mb-3 text-center text-sm",children:[(0,r.jsx)("span",{className:"font-bold text-github-green",children:l.myGoRank?"출근 ".concat(l.myGoRank,"등"):""}),l.myGoRank&&l.myLeaveRank&&(0,r.jsx)("span",{className:"mx-2",children:"|"}),(0,r.jsx)("span",{className:"font-bold text-purple-500",children:l.myLeaveRank?"퇴근 ".concat(l.myLeaveRank,"등"):""}),(0,r.jsxs)("span",{className:"ml-2 text-github-muted text-xs",children:["(출근 ",l.goTotal,"명, 퇴근 ",l.leaveTotal,"명)"]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-3 gap-2 mb-4",children:[(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"text-base font-bold text-github-green mb-1",children:l.totalUsers}),(0,r.jsx)("div",{className:"text-github-muted text-xs",children:"참여자"})]}),(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"text-base font-bold text-yellow-500 mb-1",children:"\uD83C\uDF05"}),(0,r.jsx)("div",{className:"text-github-muted text-xs",children:"출근왕"}),(0,r.jsx)("div",{className:"text-github-text text-xs mt-1 truncate",children:l.earlyBird})]}),(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"text-base font-bold text-purple-500 mb-1",children:"\uD83C\uDF19"}),(0,r.jsx)("div",{className:"text-github-muted text-xs",children:"칼퇴왕"}),(0,r.jsx)("div",{className:"text-github-text text-xs mt-1 truncate",children:l.nightOwl})]})]}),(0,r.jsxs)("div",{className:"flex flex-col md:flex-row gap-4 justify-center items-stretch mb-2",children:[(0,r.jsxs)("div",{className:"flex-1 min-w-[180px] bg-github-card border-t border-thin border-github-borderLight rounded-md flex flex-col items-center p-2",children:[(0,r.jsxs)("h3",{className:"text-github-text text-xs font-medium mb-2 text-center flex items-center",children:[(0,r.jsx)("span",{className:"w-2 h-2 rounded-full bg-green-400 mr-2"}),"기분 분포"]}),l.moodDistribution.length>0?(0,r.jsx)(o.Vd,{data:{labels:l.moodDistribution.map(e=>e.emoji),datasets:[{label:"기분 분포",data:l.moodDistribution.map(e=>e.count),backgroundColor:"rgba(34,197,94,0.2)",borderColor:"rgba(34,197,94,1)",borderWidth:2,pointBackgroundColor:"rgba(34,197,94,1)",pointBorderColor:"#fff",pointRadius:5}]},options:{responsive:!0,plugins:{legend:{display:!1}},scales:{r:{angleLines:{display:!1},grid:{color:"#333"},pointLabels:{color:"#fff",font:{size:12}},ticks:{color:"#fff",stepSize:1,backdropColor:"transparent"},min:0}}},style:{maxWidth:160,margin:"0 auto"}}):(0,r.jsx)("div",{className:"text-github-muted text-center py-4 text-xs",children:"데이터 없음"})]}),(0,r.jsxs)("div",{className:"flex-1 min-w-[180px] bg-github-card border-t border-thin border-github-borderLight rounded-md flex flex-col items-center p-2",children:[(0,r.jsx)("h3",{className:"text-github-text text-xs font-medium mb-2 text-center",children:"\uD83C\uDF05 출근 시간 분포"}),(0,r.jsx)(o.O5,{data:{labels:Array.from({length:24},(e,t)=>"".concat(t,"시")),datasets:[{label:"출근",data:Array.from({length:24},(e,t)=>{var s;return(null==(s=l.commuteTimesGo.find(e=>e.hour===t))?void 0:s.count)||0}),backgroundColor:Array.from({length:24},(e,t)=>"rgba(34,197,94,".concat(.3+t/23*.7,")")),borderColor:"rgba(34,197,94,1)",borderWidth:1}]},options:{responsive:!0,plugins:{legend:{display:!1},tooltip:{backgroundColor:"#161b22",titleColor:"#c9d1d9",bodyColor:"#c9d1d9",borderColor:"#21262d",borderWidth:1}},scales:{r:{grid:{color:"#333"},pointLabels:{color:"#c9d1d9",font:{size:10}},ticks:{color:"#8b949e",backdropColor:"transparent",stepSize:1}}}},style:{maxWidth:160,margin:"0 auto"}})]}),(0,r.jsxs)("div",{className:"flex-1 min-w-[180px] bg-github-card border-t border-thin border-github-borderLight rounded-md flex flex-col items-center p-2",children:[(0,r.jsx)("h3",{className:"text-github-text text-xs font-medium mb-2 text-center",children:"\uD83C\uDF19 퇴근 시간 분포"}),(0,r.jsx)(o.O5,{data:{labels:Array.from({length:24},(e,t)=>"".concat(t,"시")),datasets:[{label:"퇴근",data:Array.from({length:24},(e,t)=>{var s;return(null==(s=l.commuteTimesLeave.find(e=>e.hour===t))?void 0:s.count)||0}),backgroundColor:Array.from({length:24},(e,t)=>"rgba(139,92,246,".concat(.3+t/23*.7,")")),borderColor:"rgba(139,92,246,1)",borderWidth:1}]},options:{responsive:!0,plugins:{legend:{display:!1},tooltip:{backgroundColor:"#161b22",titleColor:"#c9d1d9",bodyColor:"#c9d1d9",borderColor:"#21262d",borderWidth:1}},scales:{r:{grid:{color:"#333"},pointLabels:{color:"#c9d1d9",font:{size:10}},ticks:{color:"#8b949e",backdropColor:"transparent",stepSize:1}}}},style:{maxWidth:160,margin:"0 auto"}})]})]}),0===l.totalUsers&&(0,r.jsxs)("div",{className:"text-center py-8",children:[(0,r.jsx)("div",{className:"text-4xl mb-4",children:"\uD83D\uDCC8"}),(0,r.jsx)("div",{className:"text-github-muted",children:"아직 데이터가 없어요."}),(0,r.jsx)("div",{className:"text-github-muted text-sm mt-2",children:"첫 번째로 출근/퇴근을 기록해보세요!"})]})]})}d.t1.register(d.pr,d.FN,d.No,d.dN,d.m_,d.s$,d.G5,d.Bs);var m=s(5010);function h(e){let{moods:t,commutes:s,loading:a}=e,[l,n]=(0,i.useState)([]),[o,d]=(0,i.useState)([]),[c,h]=(0,i.useState)("moods"),[u,x]=(0,i.useState)(!1);(0,i.useEffect)(()=>{let e=new Date,r=new Date(e.getFullYear(),e.getMonth(),e.getDate()).getTime(),i=r+864e5,a=t.filter(e=>e.timestamp>=r&&e.timestamp<i).sort((e,t)=>t.timestamp-e.timestamp),l=s.filter(e=>e.timestamp>=r&&e.timestamp<i).sort((e,t)=>t.timestamp-e.timestamp);n(a),d(l)},[t,s]),(0,i.useEffect)(()=>{x(!1)},[c]);let b=e=>new Date(e).toLocaleTimeString("ko-KR",{hour:"2-digit",minute:"2-digit"});return a?(0,r.jsx)("div",{className:"bg-github-card rounded-lg p-6",children:(0,r.jsxs)("div",{className:"flex items-center justify-center h-32",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-github-green"}),(0,r.jsx)("span",{className:"ml-2 text-github-text",children:"피드 로딩 중..."})]})}):(0,r.jsxs)("div",{className:"bg-github-card border-b border-thin border-github-borderLight rounded-md",children:[(0,r.jsx)("div",{className:"border-b border-thin border-github-borderLight",children:(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsxs)("button",{onClick:()=>h("moods"),className:"flex-1 py-3 px-4 text-xs font-bold transition-colors ".concat("moods"===c?"text-github-green border-b border-github-green":"text-github-muted hover:text-github-text"),children:["\uD83D\uDE0A 기분 (",l.length,")"]}),(0,r.jsxs)("button",{onClick:()=>h("commutes"),className:"flex-1 py-3 px-4 text-xs font-bold transition-colors ".concat("commutes"===c?"text-github-green border-b border-github-green":"text-github-muted hover:text-github-text"),children:["⏰ 출퇴근 (",o.length,")"]})]})}),(0,r.jsx)("div",{className:"p-4",children:"moods"===c?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"space-y-2",children:l.slice(0,u?l.length:5).map((e,t)=>(0,r.jsx)(m.A,{mood:e},t))}),l.length>5&&!u&&(0,r.jsx)("button",{className:"w-full mt-3 py-2 px-3 rounded-md border border-github-borderLight bg-github-btnBg text-github-btnText text-xs font-semibold shadow-sm hover:bg-github-btnHover hover:border-github-border transition-all duration-150",onClick:()=>x(!0),children:"기분 더보기"})]}):(0,r.jsxs)("div",{className:"space-y-3",children:[o.length>0?o.slice(0,8).map(e=>(0,r.jsxs)("div",{className:"flex items-center justify-between p-2 bg-github-bg rounded-sm",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("div",{className:"text-base ".concat("출근"===e.type?"text-github-green":"text-orange-500"),children:"출근"===e.type?"\uD83C\uDF05":"\uD83C\uDFE0"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-github-text font-medium text-sm",children:e.nickname}),(0,r.jsx)("div",{className:"text-github-muted text-xs",children:e.type})]})]}),(0,r.jsx)("div",{className:"text-github-muted text-xs",children:b(e.timestamp)})]},e.id)):(0,r.jsxs)("div",{className:"text-center py-8",children:[(0,r.jsx)("div",{className:"text-2xl mb-3",children:"⏰"}),(0,r.jsx)("div",{className:"text-github-muted text-sm",children:"아직 아무도 출퇴근을 기록하지 않았어요."}),(0,r.jsx)("div",{className:"text-github-muted text-xs mt-2",children:"첫 번째로 출근/퇴근을 기록해보세요!"})]}),o.length>8&&(0,r.jsx)("div",{className:"pt-4 flex justify-center",children:(0,r.jsxs)("button",{className:"w-full max-w-xs py-2 rounded bg-transparent text-github-muted text-[10px] font-semibold border border-github-borderMuted hover:bg-[#21262d] hover:text-github-green transition-colors duration-150",onClick:()=>x(!0),children:["+",o.length-8,"개의 기록 더 보기"]})})]})})]})}let u=["꿈꾸는","노래하는","모험하는","별을쫓는","하늘을나는","세상을바꾸는","마법을믿는","용감한","상상하는","춤추는","웃음짓는","빛을찾는","책을읽는","그림그리는","발명하는","우주를향한","시간을여행하는","마음을나누는","희망을심는","행복을찾는","자유를꿈꾸는","바람을타는","비밀을간직한","미래를여는","추억을담는","모두를위한","세상을여행하는"],x=["용사","가수","과학자","마법사","모험가","발명가","화가","작가","탐험가","요리사","비행사","사진가","음악가","댄서","감독","감정가","연주가","코미디언","운동선수","감정사","건축가","디자이너","엔지니어","교사","의사","수의사","로봇공학자","천문학자","심리학자","철학자","역사학자","환경운동가","동화작가","마라토너","기상캐스터","우주비행사","로켓과학자","동물조련사","마술사","정원사","바리스타","파티시에","플로리스트","소방관","경찰관","기자","모델","스타트업창업가","유튜버","게임개발자","AI연구자","데이터분석가"];function b(){let e=u[Math.floor(Math.random()*u.length)],t=x[Math.floor(Math.random()*x.length)],s=Math.floor(9999*Math.random())+1;return"".concat(e).concat(t).concat(s)}var g=s(2056),f=s(1368),p=s(5647);let j="https://yrrmtcvviactkmxibodu.supabase.co",v="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inlycm10Y3Z2aWFjdGtteGlib2R1Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTE0NDA4MjYsImV4cCI6MjA2NzAxNjgyNn0.K1ZxrtCWKCLLpPNJf0CkR0H7LRNsvMb07Uy2TuFXwh0",N=()=>{if(!j||!v)throw Error("Supabase 환경변수가 누락되었습니다.");return(0,p.UU)(j,v)},y=()=>{let[e,t]=(0,i.useState)([]),[s,r]=(0,i.useState)([]),[a,l]=(0,i.useState)([]),[n,o]=(0,i.useState)(!0),d=async()=>{try{let{data:e,error:s}=await N().from("commutes").select("*").order("timestamp",{ascending:!1}).limit(50);if(s)throw s;t(e||[])}catch(e){console.error("출퇴근 기록 가져오기 실패:",e)}},c=async()=>{try{let{data:e,error:t}=await N().from("moods").select("*").order("timestamp",{ascending:!1}).limit(50);if(t)throw t;r(e||[])}catch(e){console.error("기분 데이터 가져오기 실패:",e)}},m=async e=>{try{let{error:t}=await N().from("commutes").insert([e]);if(t)throw t;await d()}catch(e){throw console.error("출퇴근 기록 추가 실패:",e),e}},h=async e=>{try{let{error:t}=await N().from("moods").insert([e]);if(t)throw t;await c()}catch(e){throw console.error("기분 데이터 추가 실패:",e),e}},u=async e=>{try{let{error:t}=await N().from("game_scores").insert([e]);if(t)throw t}catch(e){throw console.error("게임 점수 저장 실패:",e),e}},x=(0,i.useCallback)(async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;try{let s=N().from("game_scores").select("*").eq("game",e);if("commantle"===e){let e=new Date().toISOString().slice(0,10);s=s.gte("created_at",e+"T00:00:00").lt("created_at",e+"T23:59:59")}let{data:r,error:i}=await s.order("score",{ascending:!1}).limit(t);if(i)throw i;return l(r||[]),r||[]}catch(e){return console.error("게임 점수 조회 실패:",e),[]}},[]);return(0,i.useEffect)(()=>{(async()=>{o(!0),await Promise.all([d(),c()]),o(!1)})();let e=N(),t=e.channel("commutes_changes").on("postgres_changes",{event:"*",schema:"public",table:"commutes"},()=>{d()}).subscribe(),s=e.channel("moods_changes").on("postgres_changes",{event:"*",schema:"public",table:"moods"},()=>{c()}).subscribe();return()=>{t.unsubscribe(),s.unsubscribe()}},[]),{commutes:e,moods:s,gameScores:a,loading:n,addCommute:m,addMood:h,fetchCommutes:d,fetchMoods:c,addGameScore:u,fetchGameScores:x}};function w(){let[e,t]=(0,i.useState)([]),[s,r]=(0,i.useState)(""),[a,l]=(0,i.useState)(""),[n,o]=(0,i.useState)(!1),{commutes:d,addCommute:c}=y();(0,i.useEffect)(()=>{var e;let t,s=((t=localStorage.getItem("go-home-nickname"))&&(e=t,["꿈꾸는","노래하는","모험하는","별을쫓는","하늘을나는","세상을바꾸는","마법을믿는","용감한","상상하는","춤추는","웃음짓는","빛을찾는","책을읽는","그림그리는","발명하는","우주를향한","시간을여행하는","마음을나누는","희망을심는","행복을찾는","자유를꿈꾸는","바람을타는","비밀을간직한","미래를여는","추억을담는","모두를위한","세상을여행하는"].some(t=>e.startsWith(t)))||(t=b(),localStorage.setItem("go-home-nickname",t)),t);if(s)r(s);else{let e=b();r(e),localStorage.setItem("go-home-nickname",e)}let i=(0,g.ND)();if(i)l(i);else{let e=(0,f.A)();(0,g.J9)(e),l(e)}},[]),(0,i.useEffect)(()=>{let e=new Date,s=new Date(e.getFullYear(),e.getMonth(),e.getDate()).getTime(),r=s+864e5;t(d.filter(e=>e.uuid===a&&e.timestamp>=s&&e.timestamp<r))},[d,a]);let m=async e=>{o(!0);try{let t={uuid:a,type:e,timestamp:Date.now(),nickname:s};return await c(t),t}catch(e){throw console.error("Failed to record commute:",e),e}finally{o(!1)}};return{todayRecords:e,nickname:s,isLoading:n,recordCommute:m,getTodayCommute:()=>e.find(e=>"출근"===e.type),getTodayLeave:()=>e.find(e=>"퇴근"===e.type),hasCommutedToday:()=>Array.isArray(e)&&e.some(e=>"출근"===e.type),hasLeftToday:()=>Array.isArray(e)&&e.some(e=>"퇴근"===e.type),uuid:a}}var S=s(5418),k=s.n(S);let D=["시말서","에어컨","사내식당","희망","부서","해방","불안","기안","공간","우울"];function C(e){let t=new Date,s=new Date(2024,0,1,9,0,0),r=Math.floor((t.getTime()-s.getTime())/864e5)%e.length;return e[r]}let I="commantle-messages",L="commantle-correct";function T(){let[e,t]=(0,i.useState)(null),[s,a]=(0,i.useState)(""),[l,n]=(0,i.useState)(""),[o,d]=(0,i.useState)([]),[c,m]=(0,i.useState)(null),[h,u]=(0,i.useState)(!1),{addGameScore:x,fetchGameScores:b,gameScores:g}=y(),{nickname:f}=w();return(0,i.useEffect)(()=>{var e;t(C(D)),a((e=C(D),k().d(e,!0).map(e=>e[0]).join("")));let s=new Date().toISOString().slice(0,10),r=localStorage.getItem(I);r&&d(JSON.parse(r).filter(e=>e.date===s)),localStorage.getItem(L)===s&&u(!0)},[]),(0,i.useEffect)(()=>{if(h&&o.length>0){let e=new Date().toISOString().slice(0,10);localStorage.getItem("commantle-score-saved")!==e&&(x({nickname:f,game:"commantle",score:o.length}),localStorage.setItem("commantle-score-saved",e))}},[h]),(0,i.useEffect)(()=>{b("commantle",5)},[h]),(0,r.jsxs)("div",{className:"bg-github-card rounded-lg p-4 mt-6",children:[(0,r.jsx)("h3",{className:"text-github-text font-bold mb-2",children:"꼬맨틀(Commantle) 게임"}),(0,r.jsxs)("div",{className:"text-github-muted text-sm mb-2",children:["오늘의 힌트(초성): ",(0,r.jsx)("span",{className:"font-bold",children:s||"(로딩중)"})]}),(0,r.jsxs)("form",{onSubmit:t=>{if(t.preventDefault(),!l.trim()||!e)return;let s=new Date().toISOString().slice(0,10),r=function(e,t){let s=k().d(e,!0).flat(),r=k().d(t,!0).flat(),i=new Set(s),a=new Set(r);return[...i].filter(e=>a.has(e)).length/Math.max(i.size,a.size,1)}(l.trim(),e),i=r>=.75?{msg:"완벽하게 통했습니다!",emoji:"\uD83D\uDD25"}:r>=.5?{msg:"꽤 연관 있어요!",emoji:"\uD83D\uDE0E"}:r>=.3?{msg:"살짝 엇나갔네요",emoji:"\uD83E\uDD14"}:{msg:"노선이 좀 달라요...",emoji:"\uD83E\uDDCA"};m({score:r,msg:i.msg,emoji:i.emoji});let a=[...o,{text:l.trim(),date:s,sim:r}];d(a),localStorage.setItem(I,JSON.stringify(a)),n(""),1===r&&(u(!0),localStorage.setItem(L,s))},className:"flex gap-2 mb-2",children:[(0,r.jsx)("input",{type:"text",className:"flex-1 border border-github-border rounded px-2 py-1 bg-github-bg text-github-text",placeholder:h?"정답을 맞추셨습니다!":"한 줄 멘트를 입력하세요",value:l,onChange:e=>n(e.target.value),disabled:!e||h}),(0,r.jsx)("button",{type:"submit",className:"bg-github-green text-white rounded px-4 py-1 font-bold disabled:opacity-60",disabled:!e||!l.trim()||h,children:"제출"})]}),c&&(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,r.jsx)("div",{className:"text-2xl",children:c.emoji}),(0,r.jsxs)("div",{className:"text-github-text font-bold",children:["유사도: ",(100*c.score).toFixed(0),"%"]}),(0,r.jsx)("div",{className:"text-github-muted text-sm",children:c.msg}),(0,r.jsx)("div",{className:"flex-1 h-2 bg-github-border rounded ml-2",children:(0,r.jsx)("div",{className:"h-2 rounded bg-github-green",style:{width:"".concat(Math.round(100*c.score),"%"),transition:"width 0.7s"}})})]}),(0,r.jsx)("div",{className:"text-github-muted text-xs mt-2",children:"오늘의 꼬맨틀"}),(0,r.jsxs)("ul",{className:"mt-1 space-y-1 border-t border-thin border-github-borderLight pt-2",children:[0===o.length&&(0,r.jsx)("li",{className:"text-github-muted text-xs",children:"아직 멘트가 없습니다."}),o.slice().sort((e,t)=>{var s,r;return(null!=(s=t.sim)?s:0)-(null!=(r=e.sim)?r:0)}).slice(0,5).map((e,t)=>(0,r.jsxs)("li",{className:"bg-github-bg rounded px-2 py-1 text-github-text text-sm flex items-center gap-2",children:[(0,r.jsx)("span",{children:e.text}),"number"==typeof e.sim&&(0,r.jsxs)("div",{className:"flex-1 flex items-center gap-2 ml-2",children:[(0,r.jsx)("div",{className:"h-2 bg-github-border rounded w-full relative",style:{minWidth:40},children:(0,r.jsx)("div",{className:"h-2 rounded bg-green-500 absolute top-0 left-0",style:{width:"".concat(Math.round(100*e.sim),"%"),transition:"width 0.7s"}})}),(0,r.jsxs)("span",{className:"text-github-muted text-xs",style:{minWidth:32,textAlign:"right"},children:[Math.round(100*e.sim),"%"]})]})]},t))]}),h&&(0,r.jsx)("div",{className:"text-github-green font-bold mt-3",children:"정답을 맞추셨습니다! 오늘은 더 이상 입력할 수 없습니다."}),h&&(0,r.jsxs)("div",{className:"bg-github-card rounded-md p-2 mt-4",children:[(0,r.jsx)("h4",{className:"text-github-text text-xs font-bold mb-2",children:"\uD83E\uDD47 꼬맨틀 TOP5 (시도횟수 낮을수록 1등)"}),(0,r.jsx)("ul",{className:"space-y-1",children:g&&g.length>0?g.sort((e,t)=>e.score-t.score).map((e,t)=>{var s;return(0,r.jsxs)("li",{className:"flex items-center text-xs",children:[(0,r.jsx)("span",{className:"w-5 text-center font-bold",children:t+1}),(0,r.jsx)("span",{className:"flex-1 truncate",children:e.nickname}),(0,r.jsxs)("span",{className:"w-12 text-right font-mono",children:[e.score,"회"]}),(0,r.jsx)("span",{className:"ml-2 text-github-muted text-[10px]",children:null==(s=e.created_at)?void 0:s.slice(5,10)})]},e.id||t)}):(0,r.jsx)("li",{className:"text-github-muted text-xs",children:"아직 기록 없음"})})]})]})}function E(e){let{isActive:t}=e,s=(0,i.useRef)(null),[a,l]=(0,i.useState)("idle"),[n,o]=(0,i.useState)(0),[d,c]=(0,i.useState)(0),[m,h]=(0,i.useState)(0),u=(0,i.useRef)({dino:{x:50,y:150,width:20,height:20},obstacles:[],groundY:170,gameSpeed:5,gravity:.8,jumpVelocity:-15,velocity:0,animationId:0}),[x,b]=(0,i.useState)({width:600,height:200}),{addGameScore:g,fetchGameScores:f,gameScores:p}=y(),{nickname:j}=w();(0,i.useEffect)(()=>{let e=()=>{window.innerWidth<700?b({width:window.innerWidth-32,height:210}):b({width:600,height:220})};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),(0,i.useEffect)(()=>{let e=localStorage.getItem("dino-high-score");e&&c(parseInt(e))},[]),(0,i.useEffect)(()=>{u.current.groundY=x.height-40},[x.height]),(0,i.useEffect)(()=>{if(!t||!s.current)return;let e=s.current.getContext("2d");if(!e)return;let r=u.current,i=e=>{("Space"===e.code||"ArrowUp"===e.code)&&(e.preventDefault(),"idle"===a?v():"playing"===a&&m<2&&N())};document.addEventListener("keydown",i);let l=()=>{"playing"===a&&(S(),C(e),r.animationId=requestAnimationFrame(l))};return"playing"===a&&l(),()=>{document.removeEventListener("keydown",i),r.animationId&&cancelAnimationFrame(r.animationId)}},[t,a,m]);let v=()=>{l("playing"),o(0),u.current.obstacles=[],u.current.gameSpeed=5,u.current.velocity=0,h(0)},N=()=>{m<2&&(h(m+1),u.current.velocity=-7.5)},S=()=>{let e=u.current;if(m>0&&(e.dino.y+=e.velocity,e.velocity+=e.gravity,e.dino.y>=e.groundY-e.dino.height&&(e.dino.y=e.groundY-e.dino.height,h(0),e.velocity=0)),.012>Math.random()){let t={x:x.width+24,y:e.groundY-18,width:18,height:18};e.obstacles.push(t)}e.obstacles=e.obstacles.filter(t=>(t.x-=e.gameSpeed+2,t.x>-t.width)),e.obstacles.forEach(t=>{e.dino.x<t.x+t.width&&e.dino.x+e.dino.width>t.x&&e.dino.y<t.y+t.height&&e.dino.y+e.dino.height>t.y&&I()}),o(e=>e+1),e.gameSpeed=4+Math.min(.0015*n,2.5)},k=(e,t)=>{e.save(),e.translate(t.x,t.y),e.fillStyle="#58a6ff",e.fillRect(0,8,16,8),e.fillRect(12,0,8,8),e.fillRect(0,16,6,6),e.fillRect(10,16,6,6),e.fillStyle="#1e293b",e.fillRect(17,3,2,2),e.restore()},D=(e,t)=>{e.save(),e.translate(t.x,t.y),e.fillStyle="#fbbf24",e.beginPath(),e.arc(9,9,9,0,2*Math.PI),e.fill(),e.strokeStyle="#b45309",e.lineWidth=2,e.stroke(),e.restore()},C=e=>{let t=u.current;e.fillStyle="#0d1117",e.fillRect(0,0,x.width,x.height),e.fillStyle="#21262d",e.fillRect(0,t.groundY,x.width,30),k(e,t.dino),t.obstacles.forEach(t=>D(e,t)),e.fillStyle="#f0f6fc",e.font="12px monospace",e.fillText("Score: ".concat(n),10,20),e.fillText("High: ".concat(d),10,35)},I=()=>{l("gameOver"),n>d&&(c(n),localStorage.setItem("dino-high-score",n.toString()),g({nickname:j,game:"dino",score:n}))};return((0,i.useEffect)(()=>{t&&f("dino",5)},[t,a]),t)?(0,r.jsxs)("div",{className:"bg-github-card rounded-md p-4",children:[(0,r.jsx)("h3",{className:"text-github-text font-semibold mb-3 text-sm",children:"\uD83E\uDD96 도트 공룡 러너 (운석 피하기)"}),(0,r.jsxs)("div",{className:"flex flex-col items-center space-y-3",children:[(0,r.jsx)("canvas",{ref:s,width:x.width,height:x.height,className:"border border-github-borderLight rounded-md bg-github-bg touch-none",onTouchStart:()=>{"idle"===a?v():"playing"===a&&m<2&&N()},style:{maxWidth:"100%",height:"auto"}}),(0,r.jsxs)("div",{className:"text-center space-y-2",children:["idle"===a&&(0,r.jsx)("div",{className:"text-github-muted text-xs",children:"스페이스바 또는 ↑ 키를 눌러 시작하세요"}),"gameOver"===a&&(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("div",{className:"text-red-400 font-bold text-sm",children:"게임 오버!"}),(0,r.jsxs)("div",{className:"text-github-text text-xs",children:["최고 점수: ",d]}),(0,r.jsx)("button",{onClick:()=>{l("idle"),o(0),u.current.obstacles=[],u.current.gameSpeed=5,u.current.dino.y=u.current.groundY-u.current.dino.height,h(0)},className:"px-4 py-2 bg-github-green text-white rounded-md text-xs font-semibold hover:bg-github-green/90 transition-colors",children:"다시 시작"})]}),"playing"===a&&(0,r.jsx)("div",{className:"text-github-muted text-xs",children:"스페이스바 또는 ↑ 키로 점프"})]}),(0,r.jsxs)("div",{className:"bg-github-card rounded-md p-2 mb-3",children:[(0,r.jsx)("h4",{className:"text-github-text text-xs font-bold mb-2",children:"\uD83E\uDD96 공룡러너 TOP5"}),(0,r.jsx)("ul",{className:"space-y-1",children:p&&p.length>0?p.map((e,t)=>{var s;return(0,r.jsxs)("li",{className:"flex items-center text-xs",children:[(0,r.jsx)("span",{className:"w-5 text-center font-bold",children:t+1}),(0,r.jsx)("span",{className:"flex-1 truncate",children:e.nickname}),(0,r.jsx)("span",{className:"w-12 text-right font-mono",children:e.score}),(0,r.jsx)("span",{className:"ml-2 text-github-muted text-[10px]",children:null==(s=e.created_at)?void 0:s.slice(5,10)})]},e.id||t)}):(0,r.jsx)("li",{className:"text-github-muted text-xs",children:"아직 기록 없음"})})]})]})]}):null}let R=[{key:"commantle",label:"꼬맨틀"},{key:"dino",label:"공룡 러너"}];function O(){let[e,t]=(0,i.useState)("commantle");return(0,r.jsxs)("div",{className:"bg-github-card rounded-lg p-4 mt-6",children:[(0,r.jsx)("div",{className:"flex border-b border-github-borderLight mb-4",children:R.map(s=>(0,r.jsx)("button",{className:"px-4 py-2 text-xs font-semibold transition-colors border-b-2 -mb-px\n              ".concat(e===s.key?"text-github-green border-github-green bg-github-bg":"text-github-muted border-transparent hover:text-github-text","\n            "),onClick:()=>t(s.key),type:"button",children:s.label},s.key))}),(0,r.jsxs)("div",{className:"min-h-[340px] flex flex-col justify-center",children:["commantle"===e&&(0,r.jsx)(T,{}),"dino"===e&&(0,r.jsx)(E,{isActive:!0})]})]})}var M=s(7410);let A=[{key:"commantle",label:"꼬맨틀 랭킹"},{key:"dino",label:"공룡러너 랭킹"}];function _(){let[e,t]=(0,i.useState)("commantle"),{fetchGameScores:s}=y(),[a,l]=(0,i.useState)([]);(0,i.useEffect)(()=>{s(e,5).then(l)},[e]);let n=a.slice().sort((t,s)=>"commantle"===e?t.score-s.score:s.score-t.score);return(0,r.jsxs)("div",{className:"bg-github-card rounded-md p-4 mt-4 border border-github-borderLight",children:[(0,r.jsx)("div",{className:"flex mb-3 border-b border-github-borderLight items-center",children:A.map(s=>(0,r.jsx)("button",{className:"px-4 py-2 text-xs font-semibold border-b-2 transition-colors duration-150\n              ".concat(e===s.key?"border-github-green text-github-green bg-github-bg":"border-transparent text-github-muted hover:text-github-text hover:bg-github-bg/50","\n            "),onClick:()=>t(s.key),children:s.label},s.key))}),(0,r.jsx)("ul",{className:"space-y-1",children:n&&n.length>0?n.map((t,s)=>{var i;return(0,r.jsxs)("li",{className:"flex items-center text-xs bg-github-bg rounded px-2 py-1",children:[(0,r.jsx)("span",{className:"w-5 text-center font-bold",children:s+1}),(0,r.jsx)("span",{className:"flex-1 truncate",children:t.nickname}),(0,r.jsxs)("span",{className:"w-12 text-right font-mono",children:[t.score,"commantle"===e?"회":""]}),(0,r.jsx)("span",{className:"ml-2 text-github-muted text-[10px]",children:null==(i=t.created_at)?void 0:i.slice(5,10)})]},t.id||s)}):(0,r.jsx)("li",{className:"text-github-muted text-xs",children:"아직 기록 없음"})})]})}function F(){let{nickname:e,isLoading:t,recordCommute:s,getTodayCommute:l,getTodayLeave:o,hasCommutedToday:d,hasLeftToday:m,uuid:u}=w(),{addMood:x,commutes:b,moods:g,fetchMoods:f,loading:p}=y(),[j,v]=(0,i.useState)(!1);(0,i.useEffect)(()=>{document.documentElement.classList.add("dark")},[]);let N=async e=>{try{await s(e)}catch(e){console.error("Commute recording failed:",e)}},S=async(t,s)=>{v(!0);try{let r={emoji:t,message:s,timestamp:Date.now(),nickname:e};await x(r),await f()}catch(e){console.error("Mood submission failed:",e),alert("기분 공유에 실패했습니다. 다시 시도해주세요.")}finally{v(!1)}},k=e=>new Date(e).toLocaleTimeString("ko-KR",{hour:"2-digit",minute:"2-digit"});return(0,r.jsxs)("div",{className:"min-h-screen bg-github-bg text-github-text",children:[(0,r.jsx)("header",{className:"border-b border-github-border bg-github-card",children:(0,r.jsx)("div",{className:"max-w-4xl mx-auto px-4 py-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("div",{className:"text-2xl",children:"\uD83C\uDFE0"}),(0,r.jsx)("h1",{className:"text-xl font-bold",children:"아 집에가고싶다"})]}),(0,r.jsx)("div",{className:"text-github-muted text-sm",children:e})]})})}),(0,r.jsx)("main",{className:"max-w-6xl mx-auto px-4 py-8",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-githubGutter",children:[(0,r.jsxs)("div",{className:"lg:col-span-1 space-y-githubGutter",children:[(0,r.jsx)("div",{className:"bg-github-card rounded-github shadow-github p-githubCard",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("img",{src:(0,M.T)(e,"pixel-art"),alt:"아바타",className:"w-16 h-16 rounded-full border border-github-border mx-auto mb-2 bg-white object-cover"}),(0,r.jsx)("div",{className:"text-3xl mb-2",children:"\uD83D\uDE0C"}),(0,r.jsx)("h2",{className:"text-github-text font-bold text-lg mb-2",children:e}),(0,r.jsx)("p",{className:"text-github-muted text-sm mb-4",children:"개발자 • 데이터 분석가"}),(0,r.jsxs)("div",{className:"space-y-2 text-sm",children:[l()&&(0,r.jsxs)("div",{className:"flex items-center justify-between p-2 bg-github-bg rounded",children:[(0,r.jsx)("span",{className:"text-github-muted",children:"출근"}),(0,r.jsx)("span",{className:"text-github-green font-medium",children:k(l().timestamp)})]}),o()&&(0,r.jsxs)("div",{className:"flex items-center justify-between p-2 bg-github-bg rounded",children:[(0,r.jsx)("span",{className:"text-github-muted",children:"퇴근"}),(0,r.jsx)("span",{className:"text-orange-400 font-medium",children:k(o().timestamp)})]})]})]})}),(0,r.jsxs)("div",{className:"bg-github-card rounded-github shadow-github p-githubCard",children:[(0,r.jsx)("h3",{className:"text-github-text font-medium mb-4",children:"오늘의 출퇴근"}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsx)(a,{type:"출근",onClick:()=>N("출근"),isLoading:t,hasRecorded:d(),recordTime:l()?k(l().timestamp):void 0}),(0,r.jsx)(a,{type:"퇴근",onClick:()=>N("퇴근"),isLoading:t,hasRecorded:m(),recordTime:o()?k(o().timestamp):void 0})]})]}),(0,r.jsx)(n,{onSubmit:S,isLoading:j,disabled:t}),(0,r.jsx)(_,{})]}),(0,r.jsxs)("div",{className:"lg:col-span-3 space-y-githubGutter",children:[(0,r.jsx)(c,{commutes:b,moods:g,myUuid:u}),(0,r.jsx)(O,{}),(0,r.jsx)(h,{moods:g,commutes:b,loading:p})]})]})}),(0,r.jsx)("footer",{className:"border-t border-github-border border-thin bg-github-card mt-12",children:(0,r.jsx)("div",{className:"max-w-4xl mx-auto px-4 py-6",children:(0,r.jsxs)("div",{className:"text-center text-github-muted text-sm",children:[(0,r.jsx)("p",{children:"“오늘도 출근했습니다. 그리고 기분은요...”"}),(0,r.jsx)("p",{className:"mt-2",children:"\xa9 2024 아 집에가고싶다"})]})})})]})}},7410:(e,t,s)=>{"use strict";function r(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"pixel-art";return"https://api.dicebear.com/7.x/".concat(t,"/svg?seed=").concat(encodeURIComponent(e))}s.d(t,{T:()=>r})},8400:(e,t,s)=>{Promise.resolve().then(s.bind(s,7300))}},e=>{var t=t=>e(e.s=t);e.O(0,[647,97,441,684,358],()=>t(8400)),_N_E=e.O()}]);