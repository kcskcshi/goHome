"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[261],{5200:(e,t,a)=>{a.d(t,{SupabaseProvider:()=>m,_:()=>u});var r=a(12115),s=a(55647);let n="https://yrrmtcvviactkmxibodu.supabase.co",i="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inlycm10Y3Z2aWFjdGtteGlib2R1Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTE0NDA4MjYsImV4cCI6MjA2NzAxNjgyNn0.K1ZxrtCWKCLLpPNJf0CkR0H7LRNsvMb07Uy2TuFXwh0",o=()=>{if(!n||!i)throw Error("Supabase 환경변수가 누락되었습니다.");return(0,s.UU)(n,i)};var c=a(56671),l=a(68974);let d=(0,r.createContext)(void 0),m=e=>{let{children:t}=e,{mutate:a}=(0,l.iX)(),s=async()=>{let{data:e,error:t}=await o().from("commutes").select("*").order("timestamp",{ascending:!1}).limit(50);if(t)throw t;return e||[]},n=async()=>{let{data:e,error:t}=await o().from("moods").select("*").order("timestamp",{ascending:!1}).limit(50);if(t)throw t;return e||[]},i=async()=>{let{data:e,error:t}=await o().from("game_scores").select("*").eq("game","dino").order("score",{ascending:!1}).order("created_at",{ascending:!0}).limit(10);if(t)throw t;return e||[]},m=async()=>{let e=new Date,t=new Date(e.getTime()-6e4*e.getTimezoneOffset()).toISOString().slice(0,10),{data:a,error:r}=await o().from("game_scores").select("*").eq("game","commantle").gte("created_at","".concat(t,"T00:00:00.000Z")).lte("created_at","".concat(t,"T23:59:59.999Z")).order("score",{ascending:!0}).order("created_at",{ascending:!0});if(r)throw r;return a||[]},u=async e=>{let{error:t}=await o().from("commutes").insert([e]);if(t)throw c.oR.error("출퇴근 기록 추가에 실패했습니다."),t;a("commutes")},f=async e=>{let{error:t}=await o().from("moods").insert([e]);if(t)throw c.oR.error("기분 데이터 추가에 실패했습니다."),t;a("moods")},h=async function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"commantle";try{let s=new Date,n=new Date(s.getTime()-6e4*s.getTimezoneOffset()).toISOString().slice(0,10),{data:i,error:c}=await o().from("game_scores").select("*").eq("nickname",t).eq("game",r).gte("created_at","".concat(n,"T00:00:00.000Z")).lte("created_at","".concat(n,"T23:59:59.999Z")).single();if(c&&"PGRST116"!==c.code)throw c;if(i){if(e<i.score){let{error:t}=await o().from("game_scores").update({score:e,created_at:new Date().toISOString()}).eq("id",i.id);if(t)throw t}}else{let{error:a}=await o().from("game_scores").insert([{nickname:t,game:r,score:e,created_at:new Date().toISOString()}]);if(a)throw a}a("commantle"===r?"commantleScores":"dinoScores")}catch(e){throw c.oR.error("게임 스코어 추가에 실패했습니다."),e}};return r.createElement(d.Provider,{value:{addCommute:u,addMood:f,addGameScore:h,fetchCommutes:s,fetchMoods:n,fetchDinoScores:i,fetchCommantleScores:m}},t)},u=()=>{let e=(0,r.useContext)(d);if(!e)throw Error("useSupabase must be used within a SupabaseProvider");return e}},22491:(e,t,a)=>{a.d(t,{a:()=>m});var r=a(12115);let s=["즐거운","신나는","평온한","활기찬","차분한","열정적인","창의적인","꼼꼼한","친절한","유쾌한","진지한","유연한","성실한","도전적인","긍정적인","배려하는","책임감있는","협력하는"],n=["개발자","디자이너","기획자","마케터","영업사원","회계사","의사","교사","엔지니어","작가","예술가","요리사","운동선수","음악가","사진작가","여행자","독서가","요가인"],i={COMMUTE_RECORDS:"go-home-commute-records",MOOD_DATA:"go-home-mood-data"};var o=a(51368),c=a(5200),l=a(56671),d=a(19169);function m(){let[e,t]=(0,r.useState)([]),[a,i]=(0,r.useState)(""),[m,u]=(0,r.useState)(""),[f,h]=(0,r.useState)(!1),{addCommute:x,fetchCommutes:g}=(0,c._)(),{data:p}=(0,d.Ay)("commutes",g);(0,r.useEffect)(()=>{let e=localStorage.getItem("go-home-nickname");if(e)i(e);else{let e=function(){let e=s[Math.floor(Math.random()*s.length)],t=n[Math.floor(Math.random()*n.length)],a=Math.floor(9999*Math.random())+1;return"".concat(e).concat(t).concat(a)}();i(e),localStorage.setItem("go-home-nickname",e)}let t=localStorage.getItem("go-home-uuid");if(t)u(t);else{let e=(0,o.A)();localStorage.setItem("go-home-uuid",e),u(e)}},[]),(0,r.useEffect)(()=>{if(!p)return;let e=new Date,a=new Date(e.getFullYear(),e.getMonth(),e.getDate()).getTime(),r=a+864e5;t(p.filter(e=>e.uuid===m&&e.timestamp>=a&&e.timestamp<r))},[p,m]);let v=async e=>{h(!0);try{let t={uuid:m,type:e,timestamp:Date.now(),nickname:a};return await x(t),l.oR.success("".concat(e," 기록에 성공했습니다.")),t}catch(t){throw console.error("Failed to record commute:",t),l.oR.error("".concat(e," 기록에 실패했습니다.")),t}finally{h(!1)}};return{todayRecords:e,nickname:a,isLoading:f,recordCommute:v,getTodayCommute:()=>e.find(e=>"출근"===e.type),getTodayLeave:()=>e.find(e=>"퇴근"===e.type),uuid:m}}},52814:(e,t,a)=>{a.d(t,{E:()=>o});var r=a(95155);a(12115);var s=a(74466),n=a(59434);let i=(0,s.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function o(e){let{className:t,variant:a,...s}=e;return(0,r.jsx)("div",{className:(0,n.cn)(i({variant:a}),t),...s})}},54843:(e,t,a)=>{a.d(t,{A:()=>x});var r=a(95155),s=a(12115),n=a(14474),i=a(22862),o=a(96025),c=a(52071),l=a(488),d=a(54811),m=a(66695),u=a(52814),f=a(72713);let h=["#0088FE","#00C49F","#FFBB28","#FF8042","#AF19FF"];function x(e){let{commutes:t,moods:a,myUuid:x}=e,g=new Date,p=new Date(g.getFullYear(),g.getMonth(),g.getDate()).getTime(),v=p+864e5,j=(0,s.useMemo)(()=>a.filter(e=>e.timestamp>=p&&e.timestamp<v),[a,p,v]),y=(0,s.useMemo)(()=>t.filter(e=>e.timestamp>=p&&e.timestamp<v),[t,p,v]),w=(0,s.useMemo)(()=>{let e={};return j.forEach(t=>{e[t.emoji]=(e[t.emoji]||0)+1}),Object.entries(e).map(e=>{let[t,a]=e;return{name:t,value:a}}).sort((e,t)=>t.value-e.value).slice(0,5)},[j]),N=(0,s.useMemo)(()=>y.filter(e=>"출근"===e.type).sort((e,t)=>e.timestamp-t.timestamp),[y]),b=(0,s.useMemo)(()=>y.filter(e=>"퇴근"===e.type).sort((e,t)=>e.timestamp-t.timestamp),[y]),S=(0,s.useMemo)(()=>{let e=N.findIndex(e=>e.uuid===x);return e>=0?e+1:null},[N,x]),D=(0,s.useMemo)(()=>{let e=b.findIndex(e=>e.uuid===x);return e>=0?e+1:null},[b,x]),k=(0,s.useMemo)(()=>new Set([...j.map(e=>e.nickname),...y.map(e=>e.nickname)]).size,[j,y]),M=(0,s.useMemo)(()=>{var e;return(null==(e=N[0])?void 0:e.nickname)||"아직 없음"},[N]),I=(0,s.useMemo)(()=>{var e;return(null==(e=b[0])?void 0:e.nickname)||"아직 없음"},[b]),F=(0,s.useMemo)(()=>{let e={};return N.forEach(t=>{let a=new Date(t.timestamp).getHours();e[a]=(e[a]||0)+1}),Array.from({length:24},(e,t)=>t).map(t=>({name:"".concat(t,"시"),value:e[t]||0}))},[N]),_=(0,s.useMemo)(()=>{let e={};return b.forEach(t=>{let a=new Date(t.timestamp).getHours();e[a]=(e[a]||0)+1}),Array.from({length:24},(e,t)=>t).map(t=>({name:"".concat(t,"시"),value:e[t]||0}))},[b]);return(0,r.jsxs)(m.Zp,{children:[(0,r.jsxs)(m.aR,{children:[(0,r.jsxs)(m.ZB,{className:"flex items-center gap-2",children:[(0,r.jsx)(f.A,{className:"h-5 w-5"}),"오늘의 통계"]}),(S||D)&&(0,r.jsx)(m.BT,{children:(0,r.jsxs)("div",{className:"flex items-center justify-center gap-4",children:[S&&(0,r.jsxs)(u.E,{variant:"secondary",children:["출근 ",S,"등"]}),D&&(0,r.jsxs)(u.E,{variant:"outline",children:["퇴근 ",D,"등"]}),(0,r.jsxs)("span",{className:"text-xs text-muted-foreground",children:["(출근 ",N.length,"명, 퇴근 ",b.length,"명)"]})]})})]}),(0,r.jsxs)(m.Wu,{children:[(0,r.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[(0,r.jsxs)("div",{className:"text-center space-y-2",children:[(0,r.jsx)("div",{className:"text-2xl font-bold text-primary",children:k}),(0,r.jsx)("div",{className:"text-sm text-muted-foreground",children:"참여자"})]}),(0,r.jsxs)("div",{className:"text-center space-y-2",children:[(0,r.jsx)("div",{className:"text-2xl",children:"\uD83C\uDF05"}),(0,r.jsx)("div",{className:"text-sm text-muted-foreground",children:"출근왕"}),(0,r.jsx)("div",{className:"text-sm font-medium truncate",children:M})]}),(0,r.jsxs)("div",{className:"text-center space-y-2",children:[(0,r.jsx)("div",{className:"text-2xl",children:"\uD83C\uDF19"}),(0,r.jsx)("div",{className:"text-sm text-muted-foreground",children:"칼퇴왕"}),(0,r.jsx)("div",{className:"text-sm font-medium truncate",children:I})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,r.jsxs)(m.Zp,{className:"p-4",children:[(0,r.jsx)("h4",{className:"text-sm font-medium mb-3",children:"기분 분포"}),(0,r.jsx)(n.u,{width:"100%",height:150,children:(0,r.jsxs)(i.E,{data:w,children:[(0,r.jsx)(o.W,{dataKey:"name",stroke:"#888888",fontSize:12,tickLine:!1,axisLine:!1}),(0,r.jsx)(c.h,{stroke:"#888888",fontSize:12,tickLine:!1,axisLine:!1,tickFormatter:e=>"".concat(e)}),(0,r.jsx)(l.y,{dataKey:"value",fill:"#adfa1d",radius:[4,4,0,0],children:w.map((e,t)=>(0,r.jsx)(d.f,{fill:h[t%h.length]},"cell-".concat(t)))})]})})]}),(0,r.jsxs)(m.Zp,{className:"p-4",children:[(0,r.jsx)("h4",{className:"text-sm font-medium mb-3",children:"\uD83C\uDF05 출근 시간 분포"}),(0,r.jsx)(n.u,{width:"100%",height:150,children:(0,r.jsxs)(i.E,{data:F,children:[(0,r.jsx)(o.W,{dataKey:"name",stroke:"#888888",fontSize:12,tickLine:!1,axisLine:!1}),(0,r.jsx)(c.h,{stroke:"#888888",fontSize:12,tickLine:!1,axisLine:!1,tickFormatter:e=>"".concat(e)}),(0,r.jsx)(l.y,{dataKey:"value",fill:"#8884d8",radius:[4,4,0,0]})]})})]}),(0,r.jsxs)(m.Zp,{className:"p-4",children:[(0,r.jsx)("h4",{className:"text-sm font-medium mb-3",children:"\uD83C\uDF19 퇴근 시간 분포"}),(0,r.jsx)(n.u,{width:"100%",height:150,children:(0,r.jsxs)(i.E,{data:_,children:[(0,r.jsx)(o.W,{dataKey:"name",stroke:"#888888",fontSize:12,tickLine:!1,axisLine:!1}),(0,r.jsx)(c.h,{stroke:"#888888",fontSize:12,tickLine:!1,axisLine:!1,tickFormatter:e=>"".concat(e)}),(0,r.jsx)(l.y,{dataKey:"value",fill:"#82ca9d",radius:[4,4,0,0]})]})})]})]}),0===k&&(0,r.jsxs)("div",{className:"text-center py-8",children:[(0,r.jsx)("div",{className:"text-4xl mb-4",children:"\uD83D\uDCC8"}),(0,r.jsx)("div",{className:"text-muted-foreground",children:"아직 데이터가 없어요."}),(0,r.jsx)("div",{className:"text-muted-foreground text-sm mt-2",children:"첫 번째로 출근/퇴근을 기록해보세요!"})]})]})]})}},59434:(e,t,a)=>{a.d(t,{Q:()=>c,cn:()=>o});var r=a(52596),s=a(39688),n=a(25418),i=a.n(n);function o(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,s.QP)((0,r.$)(t))}function c(e,t){let a=i().d(e,!0).flat().join(""),r=i().d(t,!0).flat().join("");return 1-function(e,t){let a=Array.from({length:e.length+1},()=>Array(t.length+1).fill(0));for(let t=0;t<=e.length;t++)a[t][0]=t;for(let e=0;e<=t.length;e++)a[0][e]=e;for(let r=1;r<=e.length;r++)for(let s=1;s<=t.length;s++)a[r][s]=Math.min(a[r-1][s]+1,a[r][s-1]+1,a[r-1][s-1]+ +(e[r-1]!==t[s-1]));return a[e.length][t.length]}(a,r)/Math.max(a.length,r.length,1)}},66695:(e,t,a)=>{a.d(t,{BT:()=>c,Wu:()=>l,ZB:()=>o,Zp:()=>n,aR:()=>i});var r=a(95155);a(12115);var s=a(59434);function n(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"card",className:(0,s.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",t),...a})}function i(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"card-header",className:(0,s.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",t),...a})}function o(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"card-title",className:(0,s.cn)("leading-none font-semibold",t),...a})}function c(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"card-description",className:(0,s.cn)("text-muted-foreground text-sm",t),...a})}function l(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"card-content",className:(0,s.cn)("px-6",t),...a})}}}]);